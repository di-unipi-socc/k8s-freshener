tosca_definitions_version: micro_tosca_yaml_1.1
description: robotshop
imports:
- micro: https://di-unipi-socc.github.io/microTOSCA/1.1/microTOSCA.yaml
topology_template:
  node_templates:
    catalogue:
      type: micro.nodes.Service
      requirements:
      - interaction: categories
      - interaction: products
    products:
      type: micro.nodes.Service
      requirements:
      - interaction: mysql
      - interaction: cart
    mysql:
      type: micro.nodes.Datastore
    categories:
      type: micro.nodes.Service
      requirements:
      - interaction: mongodb
    mongodb:
      type: micro.nodes.Datastore
    rabbitmq:
      type: micro.nodes.MessageBroker
    cart:
      type: micro.nodes.Service
      requirements:
      - interaction: rabbitmq
    payments:
      type: micro.nodes.Service
      requirements:
      - interaction: rabbitmq
      - interaction: shipping
    shipping:
      type: micro.nodes.Service
      requirements:
      - interaction: user-manager
    user-manager:
      type: micro.nodes.Service
      requirements:
      - interaction: cart
      - interaction: catalogue
    gateway:
      type: micro.nodes.MessageRouter
      requirements:
      - interaction: user-manager
  groups:
    edgenodes:
      type: micro.groups.Edge
      members:
      - gateway
      - user-manager
  relationship_templates:
    t:
      type: micro.relationships.InteractsWith
      properties:
        timeout: true
    c:
      type: micro.relationships.InteractsWith
      properties:
        circuit_breaker: true
    d:
      type: micro.relationships.InteractsWith
      properties:
        dynamic_discovery: true
    tc:
      type: micro.relationships.InteractsWith
      properties:
        timeout: true
        circuit_breaker: true
    td:
      type: micro.relationships.InteractsWith
      properties:
        timeout: true
        dynamic_discovery: true
    cd:
      type: micro.relationships.InteractsWith
      properties:
        circuit_breaker: true
        dynamic_discovery: true
    tcd:
      type: micro.relationships.InteractsWith
      properties:
        timeout: true
        circuit_breaker: true
        dynamic_discovery: true

    